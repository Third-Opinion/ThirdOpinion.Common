{
  "master": {
    "tasks": [
      {
        "id": 21,
        "title": "Create ThirdOpinion.Common.Aws.HealthLake Project",
        "description": "Create a new .NET project for AWS HealthLake functionality and migrate FHIR code from FhirTools",
        "details": "1. Create new project ThirdOpinion.Common.Aws.HealthLake in the ThirdOpinion.Common solution\n2. Copy all code from /Users/ken/code/ThirdOpinion/FhirTools/FhirTools/Fhir directory\n3. Update namespaces from FhirTools.Fhir to ThirdOpinion.Common.Aws.HealthLake\n4. Review and update all using statements and project references\n5. Add necessary NuGet packages (AWSSDK.HealthLake, Hl7.Fhir.R4)\n6. Ensure all HealthLake-specific functionality is properly isolated\n7. Update any configuration patterns to match ThirdOpinion.Common conventions",
        "testStrategy": "1. Verify all classes compile without errors\n2. Check namespace consistency throughout the project\n3. Validate AWS SDK integration points\n4. Run existing unit tests after migration to ensure functionality preservation",
        "priority": "high",
        "dependencies": [],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "Create ThirdOpinion.Common.Aws.HealthLake project structure",
            "description": "Initialize the new .NET 8 project for AWS HealthLake functionality with proper project configuration and folder structure",
            "dependencies": [],
            "details": "Create the project directory at src/ThirdOpinion.Common.Aws.HealthLake, add a new .csproj file configured for .NET 8 with standard ThirdOpinion.Common project settings (ImplicitUsings, Nullable, LangVersion=latest, etc.), and update the ThirdOpinion.Common.sln file to include the new project in the aws solution folder alongside other AWS projects",
            "status": "done",
            "testStrategy": "Verify the project builds successfully with dotnet build and appears correctly in the solution structure"
          },
          {
            "id": 2,
            "title": "Copy and organize FHIR source files from FhirTools",
            "description": "Transfer all FHIR-related code files from the FhirTools source directory to the new HealthLake project",
            "dependencies": [
              1
            ],
            "details": "Copy all files from /Users/ken/code/ThirdOpinion/FhirTools/FhirTools/Fhir including the main service files (HealthLakeFhirService.cs, AthenaFhirService.cs, interfaces, ServiceCollectionExtensions.cs) and the Exceptions subfolder. Maintain the folder structure, ensuring exception classes are properly organized in an Exceptions subdirectory",
            "status": "done",
            "testStrategy": "Validate all files are present in the correct directory structure and verify no files were missed during the copy operation"
          },
          {
            "id": 3,
            "title": "Update namespaces and refactor HealthLake-specific code",
            "description": "Refactor all copied code to use ThirdOpinion.Common.Aws.HealthLake namespace and separate HealthLake functionality from Athena",
            "dependencies": [
              2
            ],
            "details": "Update all namespace declarations from FhirTools.Fhir to ThirdOpinion.Common.Aws.HealthLake, remove AthenaFhirService.cs from this project (it belongs in the separate AthenaEhr project), keep only HealthLakeFhirService and related interfaces/exceptions. Update all using statements throughout the codebase to reference the new namespace structure",
            "status": "done",
            "testStrategy": "Use grep to verify all old namespaces are replaced, ensure no compilation errors related to namespace mismatches"
          },
          {
            "id": 4,
            "title": "Configure NuGet packages and project references",
            "description": "Add all required NuGet packages for AWS HealthLake and FHIR functionality to the project",
            "dependencies": [
              3
            ],
            "details": "Add package references to the .csproj file including AWSSDK.HealthLake, AWSSDK.Core, Hl7.Fhir.R4 (version 5.12.2 to match existing), Microsoft.Extensions.DependencyInjection.Abstractions, Microsoft.Extensions.Options, Microsoft.Extensions.Logging.Abstractions, and Microsoft.Extensions.Configuration.Abstractions. Use consistent versions with other ThirdOpinion.Common.Aws projects",
            "status": "done",
            "testStrategy": "Run dotnet restore to ensure all packages resolve correctly, verify package versions match other AWS projects in the solution"
          },
          {
            "id": 5,
            "title": "Integrate with ThirdOpinion.Common conventions and test compilation",
            "description": "Ensure the project follows ThirdOpinion.Common patterns and successfully compiles with the solution",
            "dependencies": [
              4
            ],
            "details": "Review ServiceCollectionExtensions.cs to ensure dependency injection follows the pattern used in other ThirdOpinion.Common.Aws projects, verify configuration patterns match conventions (using Options pattern with IConfiguration), ensure proper async/await patterns and cancellation token usage throughout. Run dotnet build on the entire solution to verify no compilation errors and all cross-project references work correctly",
            "status": "done",
            "testStrategy": "Execute dotnet build for the entire solution, run any existing unit tests that reference FHIR functionality to ensure backward compatibility"
          }
        ]
      },
      {
        "id": 22,
        "title": "Create ThirdOpinion.Common.AthenaEhr Project",
        "description": "Create a new .NET project for Athena EHR integration including OAuth functionality",
        "details": "1. Create new project ThirdOpinion.Common.AthenaEhr in the solution\n2. Copy relevant FHIR code from /Users/ken/code/ThirdOpinion/FhirTools/FhirTools/Fhir that relates to Athena\n3. Copy all OAuth code from /Users/ken/code/ThirdOpinion/FhirTools/FhirTools/OAuth\n4. Update namespaces to ThirdOpinion.Common.AthenaEhr\n5. Integrate OAuth handlers with Athena-specific FHIR implementations\n6. Add required OAuth NuGet packages (Microsoft.AspNetCore.Authentication.OAuth, IdentityModel)\n7. Configure dependency injection for OAuth services",
        "testStrategy": "1. Test OAuth token acquisition and refresh flows\n2. Validate Athena API endpoint connectivity\n3. Test FHIR resource CRUD operations through Athena\n4. Verify authorization header propagation",
        "priority": "high",
        "dependencies": [],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "Create ThirdOpinion.Common.AthenaEhr project structure and configuration",
            "description": "Create the new .NET 8 project ThirdOpinion.Common.AthenaEhr with proper structure following the existing solution pattern, update the solution file to include the new project",
            "dependencies": [],
            "details": "Create the project directory at /Users/ken/code/ThirdOpinion/ThirdOpinion.Common/src/ThirdOpinion.Common.AthenaEhr following the existing convention. Create a csproj file with target framework net8.0 and necessary project settings including documentation generation. Add the project to the ThirdOpinion.Common.sln solution file with appropriate GUID and configuration mappings for Debug/Release and different CPU architectures.",
            "status": "done",
            "testStrategy": "Verify project compiles successfully with dotnet build and is properly referenced in the solution"
          },
          {
            "id": 2,
            "title": "Copy and adapt Athena-specific FHIR implementations from FhirTools",
            "description": "Copy AthenaFhirService.cs and related FHIR exceptions from FhirTools/FhirTools/Fhir directory, update namespaces to ThirdOpinion.Common.AthenaEhr",
            "dependencies": [
              1
            ],
            "details": "Copy AthenaFhirService.cs from /Users/ken/code/ThirdOpinion/FhirTools/FhirTools/Fhir to the new project. Also copy the Exceptions directory with any Athena-related exception classes. Update all namespaces from FhirTools.Fhir to ThirdOpinion.Common.AthenaEhr. Review and update any using statements and references to align with ThirdOpinion.Common namespace structure. Add reference to Hl7.Fhir.R4 NuGet package.",
            "status": "done",
            "testStrategy": "Ensure all copied files compile without namespace conflicts and all FHIR types are properly resolved"
          },
          {
            "id": 3,
            "title": "Integrate OAuth implementation components from FhirTools",
            "description": "Copy all OAuth implementation files including AthenaOAuthService, token handling, and exceptions, updating namespaces and integrating with Athena FHIR service",
            "dependencies": [
              1
            ],
            "details": "Copy all files from /Users/ken/code/ThirdOpinion/FhirTools/FhirTools/OAuth directory including AthenaOAuthService.cs, IAthenaOAuthService.cs, IOAuthService.cs, OAuthException.cs, OAuthToken.cs, OAuthTokenResponse.cs, and ServiceCollectionExtensions.cs. Update namespaces to ThirdOpinion.Common.AthenaEhr.OAuth. Ensure proper integration between OAuth services and AthenaFhirService for authentication flow.",
            "status": "done",
            "testStrategy": "Test OAuth token acquisition, refresh flows, and verify proper authentication header injection into Athena API calls"
          },
          {
            "id": 4,
            "title": "Configure NuGet dependencies and package references",
            "description": "Add all required NuGet packages for OAuth, FHIR, HTTP client functionality, and dependency injection to the project file",
            "dependencies": [
              1,
              2,
              3
            ],
            "details": "Add Microsoft.AspNetCore.Authentication.OAuth and IdentityModel packages for OAuth support. Include Microsoft.Extensions.Http, Microsoft.Extensions.DependencyInjection, Microsoft.Extensions.Configuration packages for dependency injection. Add Polly for resilient HTTP calls and Microsoft.Extensions.Http.Polly for HTTP client policies. Ensure version compatibility with existing projects in the solution. Reference ThirdOpinion.Common.Fhir project if needed for shared FHIR functionality.",
            "status": "done",
            "testStrategy": "Verify all packages restore successfully and no version conflicts exist with other projects in solution"
          },
          {
            "id": 5,
            "title": "Implement service collection extensions and dependency injection setup",
            "description": "Create consolidated service collection extensions that properly register both OAuth and Athena FHIR services with appropriate configuration options",
            "dependencies": [
              2,
              3,
              4
            ],
            "details": "Merge and refactor the ServiceCollectionExtensions.cs files from both OAuth and Fhir directories into a unified extension method. Create AddAthenaEhr extension method that registers IAthenaOAuthService, IFhirSourceService/IFhirDestinationService implementations. Configure HttpClient with proper base URLs, timeout settings, and Polly retry policies. Implement configuration binding for AthenaSettings including client credentials and endpoint URLs.",
            "status": "done",
            "testStrategy": "Test dependency injection registration in a test host, verify all services resolve correctly with proper scoping"
          }
        ]
      },
      {
        "id": 23,
        "title": "Create ThirdOpinion.Common.Aws.Misc Project",
        "description": "Create a project for miscellaneous AWS utilities and migrate AWS and SecretsManager code",
        "details": "1. Create new project ThirdOpinion.Common.Aws.Misc\n2. Copy all code from /Users/ken/code/ThirdOpinion/FhirTools/FhirTools/Aws\n3. Copy all code from /Users/ken/code/ThirdOpinion/FhirTools/FhirTools/SecretsManager\n4. Update namespaces to ThirdOpinion.Common.Aws.Misc\n5. Consolidate AWS SDK dependencies (AWSSDK.Core, AWSSDK.SecretsManager)\n6. Implement unified configuration pattern for AWS services\n7. Create service collection extensions for dependency injection",
        "testStrategy": "1. Test SecretsManager retrieval with mock AWS credentials\n2. Validate AWS service client initialization\n3. Test error handling for AWS service failures\n4. Verify secret caching mechanisms if present",
        "priority": "medium",
        "dependencies": [],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "Create ThirdOpinion.Common.Aws.Misc project structure and configuration",
            "description": "Initialize the new .NET project with appropriate project configuration, dependencies, and place it in the correct location within the solution structure",
            "dependencies": [],
            "details": "Create a new .NET 8.0 class library project under src/ThirdOpinion.Common.Aws.Misc following the existing project structure pattern. Configure the .csproj file with standard settings matching other AWS projects including target framework, nullable reference types, implicit usings, and package metadata. Add the project to ThirdOpinion.Common.sln under the aws solution folder.",
            "status": "done",
            "testStrategy": "Verify the project builds successfully with dotnet build command and is properly integrated into the solution structure"
          },
          {
            "id": 2,
            "title": "Migrate AWS signature services from FhirTools",
            "description": "Copy and adapt the AWS signature service implementations including interfaces and concrete classes from the FhirTools project to the new project with updated namespaces",
            "dependencies": [
              1
            ],
            "details": "Copy IAwsSignatureService.cs, AWS4Signer.cs, and AwsSignatureService.cs from /Users/ken/code/ThirdOpinion/FhirTools/FhirTools/Aws to src/ThirdOpinion.Common.Aws.Misc. Update all namespaces from FhirTools.Aws to ThirdOpinion.Common.Aws.Misc. Add required NuGet packages including AWSSDK.Core and any dependencies needed for HTTP request signing.",
            "status": "done",
            "testStrategy": "Create unit tests to verify AWS Signature V4 signing functionality with mock HTTP requests and validate signature headers are correctly generated"
          },
          {
            "id": 3,
            "title": "Migrate SecretsManager services and configuration",
            "description": "Transfer the SecretsManager implementation including service interface, concrete implementation, and configuration classes to the new project",
            "dependencies": [
              1
            ],
            "details": "Copy ISecretsManagerService.cs and SecretsManagerService.cs from /Users/ken/code/ThirdOpinion/FhirTools/FhirTools/SecretsManager, and SecretsManagerConfig.cs from Configuration folder. Update namespaces to ThirdOpinion.Common.Aws.Misc. Add AWSSDK.SecretsManager NuGet package and dependencies like Polly for retry policies, Microsoft.Extensions.Caching.Memory for caching support.",
            "status": "done",
            "testStrategy": "Test secret retrieval with mock IAmazonSecretsManager client, verify caching behavior, test retry policies for transient failures, and validate JSON parsing of secret values"
          },
          {
            "id": 4,
            "title": "Implement dependency injection extensions and configuration pattern",
            "description": "Create ServiceCollectionExtensions class with extension methods for registering AWS services and implement a unified configuration approach",
            "dependencies": [
              2,
              3
            ],
            "details": "Create ServiceCollectionExtensions.cs following the pattern from existing AWS projects. Implement AddAwsMiscServices extension method that registers IAwsSignatureService, ISecretsManagerService with proper configuration binding. Create unified AwsMiscOptions class combining configuration for all services. Ensure proper lifecycle management (singleton/scoped/transient) based on service requirements.",
            "status": "done",
            "testStrategy": "Test dependency injection registration in a test host, verify services can be resolved correctly, test configuration binding from appsettings.json"
          },
          {
            "id": 5,
            "title": "Create comprehensive unit tests and documentation",
            "description": "Develop unit tests for all migrated services and create appropriate README documentation for the new project",
            "dependencies": [
              2,
              3,
              4
            ],
            "details": "Create a test project ThirdOpinion.Common.Aws.Misc.UnitTests following existing test project patterns. Write unit tests for SecretsManagerService including secret retrieval, caching, error handling scenarios. Write tests for AwsSignatureService covering signature generation. Create README.md documenting usage, configuration options, and examples. Ensure all tests pass and achieve reasonable code coverage.",
            "status": "done",
            "testStrategy": "Run all unit tests with dotnet test, verify code coverage meets standards, validate that mocked AWS services behave correctly in various scenarios"
          }
        ]
      },
      {
        "id": 24,
        "title": "Create ThirdOpinion.Common.Fhir.Documents Project",
        "description": "Create a project for FHIR document handling excluding CSV reader functionality",
        "details": "1. Create new project ThirdOpinion.Common.Fhir.Documents\n2. Copy code from /Users/ken/code/ThirdOpinion/FhirTools/FhirTools/Documents\n3. Exclude DocumentCsvReaderService and related CSV functionality\n4. Update namespaces to ThirdOpinion.Common.Fhir.Documents\n5. Add references to ThirdOpinion.Common.Aws.HealthLake for FHIR dependencies\n6. Refactor document interfaces to remove CSV-specific methods\n7. Implement document builders and converters for supported formats",
        "testStrategy": "1. Test document creation and serialization\n2. Validate FHIR DocumentReference resource generation\n3. Test document metadata extraction\n4. Verify exclusion of CSV reader functionality",
        "priority": "medium",
        "dependencies": [
          21
        ],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "Create ThirdOpinion.Common.Fhir.Documents project structure",
            "description": "Set up the new ThirdOpinion.Common.Fhir.Documents project with proper configuration and NuGet references",
            "dependencies": [],
            "details": "Create a new .NET 8.0 class library project named ThirdOpinion.Common.Fhir.Documents in the ThirdOpinion.Common solution. Configure the project file with appropriate properties including target framework net8.0, implicit usings, nullable reference types, and latest C# language version. Add the project to the solution file and ensure it follows the existing project structure patterns",
            "status": "done",
            "testStrategy": "Verify project builds successfully and is properly integrated into the solution"
          },
          {
            "id": 2,
            "title": "Copy and migrate document models and exceptions",
            "description": "Transfer document models and exception classes from FhirTools to the new project with updated namespaces",
            "dependencies": [
              1
            ],
            "details": "Copy all model classes from /Users/ken/code/ThirdOpinion/FhirTools/FhirTools/Documents/Models including DocumentReferenceData, BundleData, DocumentReferenceRecord, DocumentDownloadResult, and PracticeInfo. Also copy the DocumentDownloadException class. Update all namespaces from FhirTools.Documents to ThirdOpinion.Common.Fhir.Documents and ensure all using statements are correctly updated",
            "status": "done",
            "testStrategy": "Compile the project to verify all models are properly defined with correct namespaces"
          },
          {
            "id": 3,
            "title": "Migrate core document service interfaces",
            "description": "Copy and refactor document service interfaces, excluding CSV-specific functionality",
            "dependencies": [
              2
            ],
            "details": "Copy interfaces including IBinaryDownloadService, IFileNamingService, IMetadataExtractorService, IBase64ContentExtractor, INotFoundBinaryTracker, IBundleParserService, IS3StorageService, IFileOrganizationService, IPatientEverythingService, and IDocumentDownloadService. Exclude IDocumentCsvReaderService completely. Update all namespaces and remove any references to CSV reader functionality from the copied interfaces",
            "status": "done",
            "testStrategy": "Verify all interfaces compile without CSV dependencies and maintain proper abstraction"
          },
          {
            "id": 4,
            "title": "Implement document service classes",
            "description": "Transfer and adapt all non-CSV document service implementations with proper dependency injection setup",
            "dependencies": [
              3
            ],
            "details": "Copy service implementations including BinaryDownloadService, FileNamingService, MetadataExtractorService, Base64ContentExtractor, NotFoundBinaryTracker, BundleParserService, S3StorageService, FileOrganizationService, PatientEverythingService, and HealthLakeDocumentDownloadService. Update namespaces and remove any CSV-related code. Add references to ThirdOpinion.Common.Aws.S3 for S3 functionality and ThirdOpinion.Common.Fhir for FHIR dependencies",
            "status": "done",
            "testStrategy": "Test each service class individually with unit tests to ensure proper functionality"
          },
          {
            "id": 5,
            "title": "Configure dependency injection and add package references",
            "description": "Set up ServiceCollectionExtensions and add all required NuGet package references",
            "dependencies": [
              4
            ],
            "details": "Create ServiceCollectionExtensions class with AddDocumentServices extension method, excluding CSV reader registration. Add required NuGet packages including Hl7.Fhir.R4, AWSSDK.S3, Microsoft.Extensions.DependencyInjection, and any other required dependencies. Add project references to ThirdOpinion.Common.Fhir and ThirdOpinion.Common.Aws.S3. Ensure the dependency injection configuration properly registers all document services for use in applications",
            "status": "done",
            "testStrategy": "Verify dependency injection registration works correctly in a test harness and all services can be resolved"
          }
        ]
      },
      {
        "id": 25,
        "title": "Migrate Retry and RateLimiting to ThirdOpinion.Common.Misc",
        "description": "Add retry and rate limiting functionality to the existing Misc project",
        "details": "1. Copy /Users/ken/code/ThirdOpinion/FhirTools/FhirTools/Retry to ThirdOpinion.Common.Misc\n2. Copy /Users/ken/code/ThirdOpinion/FhirTools/FhirTools/RateLimiting to ThirdOpinion.Common.Misc\n3. Update namespaces to ThirdOpinion.Common.Misc\n4. Add Polly NuGet package for retry policies\n5. Implement rate limiting using System.Threading.RateLimiting\n6. Create extension methods for HttpClient with retry and rate limiting\n7. Configure default policies for common scenarios",
        "testStrategy": "1. Test exponential backoff retry logic\n2. Validate rate limiter token bucket behavior\n3. Test circuit breaker patterns if implemented\n4. Verify retry exhaustion handling",
        "priority": "medium",
        "dependencies": [],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "Copy and update Retry source files to ThirdOpinion.Common.Misc",
            "description": "Copy all Retry implementation files from FhirTools to ThirdOpinion.Common.Misc project and update namespaces from FhirTools.Retry to ThirdOpinion.Common.Misc.Retry",
            "dependencies": [],
            "details": "Copy all 6 files from /Users/ken/code/ThirdOpinion/FhirTools/FhirTools/Retry to /Users/ken/code/ThirdOpinion/ThirdOpinion.Common/src/ThirdOpinion.Common.Misc/Retry. Update namespaces from FhirTools.Retry to ThirdOpinion.Common.Misc.Retry. Ensure all using statements are updated including references to FhirTools.Fhir.Exceptions.HealthLakeException. Files to copy: IRetryPolicyService.cs, RetryMetrics.cs, ServiceCollectionExtensions.cs, RetryConfig.cs, CircuitBreakerStatus.cs, RetryPolicyService.cs",
            "status": "done",
            "testStrategy": "Verify compilation after namespace updates and ensure no broken references"
          },
          {
            "id": 2,
            "title": "Copy and update RateLimiting source files to ThirdOpinion.Common.Misc",
            "description": "Copy all RateLimiting implementation files from FhirTools to ThirdOpinion.Common.Misc project and update namespaces from FhirTools.RateLimiting to ThirdOpinion.Common.Misc.RateLimiting",
            "dependencies": [],
            "details": "Copy all 10 files from /Users/ken/code/ThirdOpinion/FhirTools/FhirTools/RateLimiting to /Users/ken/code/ThirdOpinion/ThirdOpinion.Common/src/ThirdOpinion.Common.Misc/RateLimiting. Update namespaces from FhirTools.RateLimiting to ThirdOpinion.Common.Misc.RateLimiting. Files to copy: RateLimiterService.cs, RateLimitStatus.cs, AdaptiveRateLimiter.cs, IRateLimiter.cs, RateLimitMetrics.cs, RateLimitingHttpMessageHandler.cs, IRateLimiterService.cs, ServiceCollectionExtensions.cs, TokenBucketRateLimiter.cs, RateLimitConfig.cs",
            "status": "done",
            "testStrategy": "Verify compilation after namespace updates and ensure no broken references"
          },
          {
            "id": 3,
            "title": "Add required NuGet packages and update project file",
            "description": "Update ThirdOpinion.Common.Misc.csproj to add Polly and System.Threading.RateLimiting NuGet packages, and configure proper root namespace",
            "dependencies": [
              1,
              2
            ],
            "details": "Add PackageReference for Polly (latest stable version) and System.Threading.RateLimiting to ThirdOpinion.Common.Misc.csproj. Update RootNamespace from 'Misc' to 'ThirdOpinion.Common.Misc' to match the new namespace structure. Ensure all necessary dependencies like Microsoft.Extensions.Logging and Microsoft.Extensions.DependencyInjection are included for the migrated code to compile",
            "status": "done",
            "testStrategy": "Restore NuGet packages and verify successful package installation"
          },
          {
            "id": 4,
            "title": "Create HttpClient extension methods with retry and rate limiting",
            "description": "Implement extension methods for HttpClient that integrate retry policies and rate limiting functionality for common HTTP scenarios",
            "dependencies": [
              3
            ],
            "details": "Create a new file HttpClientExtensions.cs in ThirdOpinion.Common.Misc containing extension methods like AddWithRetryPolicy(), AddWithRateLimit(), and AddWithRetryAndRateLimit(). These methods should configure HttpClient with appropriate DelegatingHandlers for retry and rate limiting. Implement default policies for common scenarios like transient failures (429, 503) and exponential backoff. Ensure methods support both IHttpClientFactory and direct HttpClient configuration",
            "status": "done",
            "testStrategy": "Test extension methods with mock HttpClient, verify retry behavior on transient failures, and validate rate limiting token consumption"
          },
          {
            "id": 5,
            "title": "Copy and adapt unit tests for Retry and RateLimiting",
            "description": "Copy existing unit tests from FhirTools.Tests and create new test files in ThirdOpinion.Common.Misc.UnitTests with updated namespaces and references",
            "dependencies": [
              4
            ],
            "details": "Copy test files from /Users/ken/code/ThirdOpinion/FhirTools/FhirTools.Tests/Retry (3 files) and /Users/ken/code/ThirdOpinion/FhirTools/FhirTools.Tests/RateLimiting (1 file) to ThirdOpinion.Common.Misc.UnitTests. Update all namespaces from FhirTools to ThirdOpinion.Common.Misc. Add tests for the new HttpClient extension methods. Ensure test project references are updated and all mocking frameworks (Moq, FluentAssertions) are properly configured",
            "status": "done",
            "testStrategy": "Run all migrated tests using dotnet test, ensure 100% pass rate, verify code coverage meets minimum requirements"
          }
        ]
      },
      {
        "id": 26,
        "title": "Migrate Logging to ThirdOpinion.Common.Logging",
        "description": "Add logging functionality to the existing Logging project",
        "details": "1. Copy /Users/ken/code/ThirdOpinion/FhirTools/FhirTools/Logging to ThirdOpinion.Common.Logging\n2. Update namespaces to ThirdOpinion.Common.Logging\n3. Ensure compatibility with existing logging infrastructure in ThirdOpinion.Common\n4. Add structured logging support using Serilog or Microsoft.Extensions.Logging\n5. Implement correlation ID tracking\n6. Create logging middleware and interceptors\n7. Configure log enrichers for AWS context",
        "testStrategy": "1. Test log output formats and levels\n2. Validate structured logging property extraction\n3. Test correlation ID propagation across service calls\n4. Verify log filtering and sampling configurations",
        "priority": "high",
        "dependencies": [],
        "status": "done",
        "subtasks": [
          {
            "id": 1,
            "title": "Copy and organize logging source files from FhirTools",
            "description": "Copy the entire Logging directory from FhirTools to ThirdOpinion.Common.Logging and organize the file structure to match the target project's conventions",
            "dependencies": [],
            "details": "Copy all files from /Users/ken/code/ThirdOpinion/FhirTools/FhirTools/Logging to ThirdOpinion.Common.Logging directory. Preserve the folder structure including any subdirectories. Identify all C# files, configuration files, and any resource files that need to be migrated. Create a mapping of old file paths to new file paths for reference during namespace updates.",
            "status": "done",
            "testStrategy": "Verify all files are copied correctly by comparing file counts and directory structures between source and destination"
          },
          {
            "id": 2,
            "title": "Update namespaces and project references throughout copied files",
            "description": "Replace all FhirTools namespace references with ThirdOpinion.Common.Logging and update using statements to match the new project structure",
            "dependencies": [
              1
            ],
            "details": "Search and replace all occurrences of 'FhirTools.Logging' namespace with 'ThirdOpinion.Common.Logging'. Update all using statements that reference FhirTools namespaces to use ThirdOpinion.Common equivalents. Ensure all internal project references are updated to point to ThirdOpinion.Common assemblies. Update any XML documentation comments that reference the old namespace.",
            "status": "done",
            "testStrategy": "Compile the project to ensure no namespace conflicts or missing references exist"
          },
          {
            "id": 3,
            "title": "Integrate Serilog and configure structured logging capabilities",
            "description": "Add Serilog NuGet packages and implement structured logging with proper configuration for various output sinks and formatting options",
            "dependencies": [
              2
            ],
            "details": "Add Serilog, Serilog.Extensions.Logging, Serilog.Sinks.Console, and Serilog.Sinks.File NuGet packages to the project. Create a LoggingConfiguration class to handle Serilog setup with structured logging support. Implement log event enrichers for adding contextual information. Configure output templates for both human-readable and JSON formats. Set up log level filtering and minimum level configurations.",
            "status": "done",
            "testStrategy": "Create unit tests to verify structured logging outputs correct JSON format and properties are properly extracted"
          },
          {
            "id": 4,
            "title": "Implement correlation ID tracking and propagation system",
            "description": "Create middleware and interceptors for automatic correlation ID generation and propagation across service boundaries",
            "dependencies": [
              3
            ],
            "details": "Create a CorrelationIdMiddleware class for ASP.NET Core applications to generate and track correlation IDs. Implement ICorrelationIdProvider interface for accessing current correlation ID. Add HTTP client handlers to automatically include correlation ID in outgoing requests. Create log enrichers to automatically add correlation ID to all log entries. Implement AsyncLocal storage for correlation ID to ensure thread-safe access across async operations.",
            "status": "done",
            "testStrategy": "Write integration tests to verify correlation ID is properly propagated through HTTP calls and appears in all related log entries"
          },
          {
            "id": 5,
            "title": "Configure AWS-specific log enrichers and CloudWatch integration",
            "description": "Implement log enrichers for AWS context information and configure CloudWatch Logs sink for centralized logging in AWS environments",
            "dependencies": [
              4
            ],
            "details": "Add Serilog.Sinks.AwsCloudWatch NuGet package for CloudWatch integration. Create AWS context enrichers to automatically add EC2 instance ID, Lambda function name, and other AWS-specific metadata to logs. Configure CloudWatch log group and stream naming conventions. Implement batching and retry logic for CloudWatch log uploads. Add configuration options for different AWS regions and credentials. Create environment-specific logging configurations for local development versus AWS deployment.",
            "status": "done",
            "testStrategy": "Test AWS enrichers with mocked AWS services and verify CloudWatch sink properly batches and sends logs"
          }
        ]
      },
      {
        "id": 27,
        "title": "Create ThirdOpinion.Common.Aws.Bedrock Project",
        "description": "Create a project for AWS Bedrock AI/ML service integration",
        "details": "1. Create new project ThirdOpinion.Common.Aws.Bedrock\n2. Copy /Users/ken/code/ThirdOpinion/FhirTools/FhirTools/Bedrock\n3. Update namespaces to ThirdOpinion.Common.Aws.Bedrock\n4. Add AWSSDK.Bedrock and AWSSDK.BedrockRuntime NuGet packages\n5. Implement model invocation abstractions\n6. Create response parsing utilities for different model types\n7. Add streaming response support for real-time inference",
        "testStrategy": "1. Test model invocation with mock responses\n2. Validate request/response serialization\n3. Test streaming response handling\n4. Verify error handling for model throttling",
        "priority": "low",
        "dependencies": [
          23
        ],
        "status": "pending",
        "subtasks": [
          {
            "id": 1,
            "title": "Create project structure and copy source files",
            "description": "Create the new ThirdOpinion.Common.Aws.Bedrock project structure in the src directory and copy all Bedrock source files from FhirTools",
            "dependencies": [],
            "details": "Create the project directory at src/ThirdOpinion.Common.Aws.Bedrock, copy all files from /Users/ken/code/ThirdOpinion/FhirTools/FhirTools/Bedrock including BedrockModels.cs, BedrockPricing.cs, BedrockService.cs, IBedrockService.cs, and ServiceCollectionExtensions.cs. Set up the initial project structure following the pattern of other AWS projects in the solution like ThirdOpinion.Common.Aws.S3",
            "status": "pending",
            "testStrategy": "Verify all source files are copied correctly with proper directory structure"
          },
          {
            "id": 2,
            "title": "Create and configure .csproj file with NuGet packages",
            "description": "Create the project file and add all required AWS SDK and other dependencies for Bedrock functionality",
            "dependencies": [
              1
            ],
            "details": "Create ThirdOpinion.Common.Aws.Bedrock.csproj following the pattern from ThirdOpinion.Common.Aws.S3.csproj. Add NuGet packages: AWSSDK.Bedrock, AWSSDK.BedrockRuntime, AWSSDK.Core, and standard Microsoft.Extensions packages. Configure project properties including target framework net8.0, nullable reference types, and documentation generation",
            "status": "pending",
            "testStrategy": "Verify project builds successfully with all required package references"
          },
          {
            "id": 3,
            "title": "Update namespaces and resolve dependencies",
            "description": "Update all namespace declarations from FhirTools.Bedrock to ThirdOpinion.Common.Aws.Bedrock and resolve internal dependencies",
            "dependencies": [
              2
            ],
            "details": "Update all namespace declarations in copied files to ThirdOpinion.Common.Aws.Bedrock. Identify and handle dependencies on other FhirTools namespaces like FhirTools.Configuration, FhirTools.Langfuse, FhirTools.Logging, FhirTools.RateLimiting, and FhirTools.Retry. Either create stubs for these services or refactor to use existing ThirdOpinion.Common patterns. Update using statements accordingly",
            "status": "pending",
            "testStrategy": "Verify all namespace references are updated correctly and code compiles without namespace errors"
          },
          {
            "id": 4,
            "title": "Add project to solution and configure streaming support",
            "description": "Add the new project to the ThirdOpinion.Common solution and implement streaming response capabilities for real-time inference",
            "dependencies": [
              3
            ],
            "details": "Add ThirdOpinion.Common.Aws.Bedrock.csproj to the ThirdOpinion.Common.sln file under the aws solution folder. Implement streaming response support methods in BedrockService for real-time model inference, including stream handling for different model types (Claude, Llama, etc.). Add appropriate async enumerable patterns for streaming responses",
            "status": "pending",
            "testStrategy": "Test solution builds with new project included and streaming methods handle responses correctly"
          },
          {
            "id": 5,
            "title": "Create unit tests and verify integration",
            "description": "Create unit test project for Bedrock functionality and verify proper integration with the solution",
            "dependencies": [
              4
            ],
            "details": "Create ThirdOpinion.Common.Aws.Bedrock.Tests project in appropriate test directory. Copy and adapt ToolConfigurationHelperTests.cs from FhirTools.Tests/Bedrock. Add tests for model invocation with mock responses, request/response serialization, streaming response handling, and error handling for model throttling. Ensure tests follow existing test patterns in the ThirdOpinion.Common solution",
            "status": "pending",
            "testStrategy": "Run all unit tests to verify Bedrock service functionality with mocked AWS responses"
          }
        ]
      },
      {
        "id": 28,
        "title": "Create ThirdOpinion.Common.Langfuse Project",
        "description": "Create a project for Langfuse observability integration",
        "details": "1. Create new project ThirdOpinion.Common.Langfuse\n2. Copy /Users/ken/code/ThirdOpinion/FhirTools/FhirTools/Langfuse\n3. Update namespaces to ThirdOpinion.Common.Langfuse\n4. Add Langfuse SDK NuGet package or implement REST client\n5. Create tracing abstractions for LLM operations\n6. Implement span creation and metric collection\n7. Add configuration for Langfuse API endpoints and keys",
        "testStrategy": "1. Test trace creation and submission\n2. Validate metric aggregation\n3. Test offline/batch mode if supported\n4. Verify sensitive data masking in traces",
        "priority": "low",
        "dependencies": [],
        "status": "in-progress",
        "subtasks": [
          {
            "id": 1,
            "title": "Create ThirdOpinion.Common.Langfuse project structure and configure dependencies",
            "description": "Set up the new ThirdOpinion.Common.Langfuse .NET project with proper folder structure, add it to the solution, and configure necessary NuGet packages including Microsoft.Extensions dependencies, HTTP client packages, and JSON serialization",
            "dependencies": [],
            "details": "Create a new class library project under src/ThirdOpinion.Common.Langfuse directory following the existing project structure pattern. Add project to ThirdOpinion.Common.sln. Configure the .csproj file with TargetFramework net8.0, nullable enabled, and add required NuGet packages: Microsoft.Extensions.Http, Microsoft.Extensions.Logging, Microsoft.Extensions.Configuration, Microsoft.Extensions.DependencyInjection, System.Text.Json. Ensure proper project reference structure matching other Common projects",
            "status": "pending",
            "testStrategy": "Verify project builds successfully and is properly integrated into the solution structure"
          },
          {
            "id": 2,
            "title": "Copy and migrate Langfuse core service implementations from FhirTools",
            "description": "Transfer the core Langfuse service files from FhirTools/FhirTools/Langfuse to the new project, updating namespaces and removing FhirTools-specific dependencies",
            "dependencies": [
              1
            ],
            "details": "Copy ILangfuseService.cs, LangfuseService.cs, ILangfuseSchemaService.cs, LangfuseSchemaService.cs, and LangfuseModels.cs from /Users/ken/code/ThirdOpinion/FhirTools/FhirTools/Langfuse. Update all namespaces from FhirTools.Langfuse to ThirdOpinion.Common.Langfuse. Remove or abstract away any direct AWS Bedrock dependencies from BedrockTracingExtensions.cs to make it provider-agnostic. Update using statements and ensure all type references are correctly resolved",
            "status": "pending",
            "testStrategy": "Ensure all copied files compile without errors after namespace updates and dependency adjustments"
          },
          {
            "id": 3,
            "title": "Implement Langfuse REST client and HTTP communication layer",
            "description": "Create HTTP client configuration and implement REST API communication for Langfuse endpoints with proper authentication, retry policies, and error handling",
            "dependencies": [
              2
            ],
            "details": "Implement LangfuseHttpClient class with configured HttpClient using IHttpClientFactory pattern. Add authentication headers support for Langfuse API keys (public and secret keys). Implement retry policies using Polly for transient failures. Create request/response serialization helpers using System.Text.Json. Add configuration models for Langfuse API endpoints (base URL, timeouts, retry settings). Implement batch ingestion endpoint support for efficient telemetry submission",
            "status": "pending",
            "testStrategy": "Test HTTP client configuration, authentication header injection, retry behavior on transient failures, and JSON serialization/deserialization of Langfuse models"
          },
          {
            "id": 4,
            "title": "Create LLM tracing abstractions and observation builders",
            "description": "Develop provider-agnostic abstractions for LLM operation tracing, span creation, and metric collection that can work with various LLM providers beyond AWS Bedrock",
            "dependencies": [
              3
            ],
            "details": "Create ILlmTracingProvider interface for provider-agnostic tracing. Implement TracingContext class for managing trace lifecycle and parent-child relationships. Create ObservationBuilder for constructing generation and span observations with proper metadata. Implement TokenUsageCalculator for tracking input/output tokens and cost calculations. Add support for streaming response tracking and completion callbacks. Create extension methods for common tracing patterns (trace wrapping, automatic span creation). Implement metric aggregation helpers for collecting performance data",
            "status": "pending",
            "testStrategy": "Unit test tracing context management, observation builder patterns, token usage calculations, and metric aggregation logic"
          },
          {
            "id": 5,
            "title": "Add configuration system and dependency injection setup",
            "description": "Implement configuration models for Langfuse API settings, create service collection extensions for dependency injection, and add data masking for sensitive information in traces",
            "dependencies": [
              4
            ],
            "details": "Create LangfuseConfiguration class with API endpoint URLs, authentication keys, batch settings, and timeout configurations. Implement ServiceCollectionExtensions.cs with AddLangfuse extension method for registering services. Add IConfiguration binding support for reading settings from appsettings.json. Implement sensitive data masking utilities to prevent PII/secrets in traces. Create health check implementation to verify Langfuse connectivity. Add support for environment-specific configurations (dev, staging, prod). Implement offline/batch mode configuration for high-volume scenarios",
            "status": "pending",
            "testStrategy": "Test configuration binding from various sources, DI registration and resolution, sensitive data masking in traces, and health check functionality"
          }
        ]
      },
      {
        "id": 29,
        "title": "Migrate Unit Tests and Create Test Projects",
        "description": "Create test projects for each migrated component and copy corresponding unit tests",
        "details": "1. Create test projects for each new project (e.g., ThirdOpinion.Common.Aws.HealthLake.Tests)\n2. Copy relevant tests from /Users/ken/code/ThirdOpinion/FhirTools/FhirTools.Tests\n3. Update namespaces and project references in all test files\n4. Add xUnit, Moq, and FluentAssertions packages to test projects\n5. Update test fixtures and mock configurations\n6. Ensure test data and resources are properly copied\n7. Configure test runners and code coverage tools\n8. Create shared test utilities project if needed",
        "testStrategy": "1. Run all migrated tests to ensure they pass\n2. Validate code coverage metrics meet requirements\n3. Test discovery works in IDE and CI/CD\n4. Verify test isolation and no cross-test dependencies",
        "priority": "high",
        "dependencies": [
          21,
          22,
          23,
          24,
          25,
          26,
          27,
          28
        ],
        "status": "pending",
        "subtasks": [
          {
            "id": 1,
            "title": "Create ThirdOpinion.Common.Aws.HealthLake.Tests project structure",
            "description": "Create the test project for HealthLake functionality with proper project configuration, including directory structure and .csproj file setup with all necessary NuGet packages",
            "dependencies": [],
            "details": "Create /Users/ken/code/ThirdOpinion/ThirdOpinion.Common/ThirdOpinion.Common.Aws.HealthLake.Tests directory and .csproj file. Configure with net8.0 target framework, add xUnit 2.9.2, Microsoft.NET.Test.Sdk 17.12.0, xunit.runner.visualstudio 2.8.2, Moq 4.20.72, Shouldly 4.2.1, and coverlet.collector 6.0.2 packages. Include proper Using statements for xUnit, Shouldly, and Moq. Add project reference to ThirdOpinion.Common.Aws.HealthLake (once created). Configure NoWarn for nullable warnings as per existing test projects pattern",
            "status": "pending",
            "testStrategy": "Validate project builds successfully and test discovery works in IDE"
          },
          {
            "id": 2,
            "title": "Migrate HealthLake and AWS signing tests from FhirTools",
            "description": "Copy and adapt HealthLakeFhirServiceTests, AwsSignatureServiceTests, and AWS4SignerTests from FhirTools.Tests to the new HealthLake test project with proper namespace updates",
            "dependencies": [
              1
            ],
            "details": "Copy /Users/ken/code/ThirdOpinion/FhirTools/FhirTools.Tests/Fhir/HealthLakeFhirServiceTests.cs and AWS test files from /Users/ken/code/ThirdOpinion/FhirTools/FhirTools.Tests/Aws directory. Update all namespaces from FhirTools.Tests to ThirdOpinion.Common.Aws.HealthLake.Tests. Update using statements and project references to point to new ThirdOpinion.Common projects. Ensure all mock configurations and test fixtures are properly updated to work with the new namespace structure",
            "status": "pending",
            "testStrategy": "Run all migrated tests to ensure they compile and pass with updated references"
          },
          {
            "id": 3,
            "title": "Create test projects for Logging and Misc components",
            "description": "Set up ThirdOpinion.Common.Logging.Tests project and update existing ThirdOpinion.Common.Misc.UnitTests with migrated retry and rate limiting tests",
            "dependencies": [
              1
            ],
            "details": "Create ThirdOpinion.Common.Logging.Tests project with same package configuration as HealthLake.Tests. Copy retry tests from /Users/ken/code/ThirdOpinion/FhirTools/FhirTools.Tests/Retry (RetryPolicyServiceTests.cs, RetryIntegrationTests.cs, HttpRequestExceptionTest.cs) to ThirdOpinion.Common.Misc.UnitTests. Copy RateLimiterServiceIntegrationTests.cs from FhirTools.Tests/RateLimiting. Update all namespaces and ensure Polly and System.Threading.RateLimiting dependencies are properly configured",
            "status": "pending",
            "testStrategy": "Verify all retry and rate limiting tests execute successfully with proper exponential backoff and token bucket behavior"
          },
          {
            "id": 4,
            "title": "Migrate test data resources and shared test utilities",
            "description": "Copy test data files, JSON configurations, and create a shared test utilities project for common test helpers, fixtures, and mock builders used across multiple test projects",
            "dependencies": [
              2,
              3
            ],
            "details": "Create ThirdOpinion.Common.TestUtilities project containing shared test fixtures, mock builders, and test data helpers. Identify and copy any test resource files (JSON, XML, CSV) from FhirTools.Tests to appropriate test project directories. Create shared mock configurations for AWS services, HTTP clients, and logging infrastructure. Implement test data builders and factories for commonly used domain objects. Ensure all test projects reference the TestUtilities project",
            "status": "pending",
            "testStrategy": "Validate shared utilities are accessible from all test projects and test data files are properly embedded or copied to output"
          },
          {
            "id": 5,
            "title": "Configure test runners and integrate code coverage reporting",
            "description": "Set up test execution configuration, code coverage collection with coverlet, and ensure all tests are discoverable in both IDE and CI/CD pipelines",
            "dependencies": [
              1,
              2,
              3,
              4
            ],
            "details": "Configure Directory.Build.props in test directory for shared test settings. Set up coverlet.msbuild or coverlet.collector for code coverage with proper exclusion filters for generated code. Create runsettings file for test execution configuration including test timeouts and parallel execution settings. Verify test discovery works in Visual Studio, VS Code, and command line (dotnet test). Configure code coverage thresholds and reporting format (opencover/cobertura). Create test script or makefile for running all tests with coverage reporting",
            "status": "pending",
            "testStrategy": "Execute full test suite with coverage reporting, verify minimum 80% coverage threshold, ensure reports generate in CI-friendly format"
          }
        ]
      },
      {
        "id": 30,
        "title": "Configure NuGet Package and Create Documentation",
        "description": "Update NuGet package configuration to include all new projects and create comprehensive documentation",
        "details": "1. Update .nuspec or PackageReference in each project for NuGet packaging\n2. Configure package metadata (version, authors, description, tags)\n3. Set up package dependencies between ThirdOpinion.Common projects\n4. Create/update ThirdOpinion.Common.FunctionalTests from FhirTools.FunctionalTests\n5. Create consolidated documentation file (ThirdOpinion.Common.Usage.md) with:\n   - Overview of each project and its purpose\n   - Key interfaces and usage patterns\n   - Configuration requirements\n   - Code examples for common scenarios\n   - Migration notes from FhirTools\n6. Update solution file to include all new projects\n7. Configure CI/CD pipeline for package publishing",
        "testStrategy": "1. Build and pack all projects successfully\n2. Test NuGet package installation in a sample project\n3. Validate package dependencies are correctly resolved\n4. Run functional tests against packaged assemblies\n5. Verify documentation is accurate and examples work",
        "priority": "high",
        "dependencies": [
          21,
          22,
          23,
          24,
          25,
          26,
          27,
          28,
          29
        ],
        "status": "pending",
        "subtasks": [
          {
            "id": 1,
            "title": "Configure NuGet Package Metadata and Update Solution File",
            "description": "Update all project files to enable NuGet packaging with proper metadata, configure the ThirdOpinion.Common meta-package, and ensure the solution file includes all new projects that will be added in dependent tasks",
            "dependencies": [],
            "details": "Update IsPackable property to true in all library projects (ThirdOpinion.Common.Fhir, ThirdOpinion.Common.Misc, ThirdOpinion.Common.Aws.* projects). Set proper PackageId, Version, Authors, Company, Description, and PackageTags for each project. Configure ThirdOpinion.Common.csproj as a meta-package that references all sub-packages. Update the solution file to include placeholders for ThirdOpinion.Common.Aws.HealthLake, ThirdOpinion.Common.Aws.Bedrock, and ThirdOpinion.Common.Fhir.Documents projects that will be created in tasks 22-27. Ensure proper solution folder structure with AWS projects grouped under the 'aws' folder and FHIR projects properly organized.",
            "status": "pending",
            "testStrategy": "Build solution with dotnet build to verify all projects compile successfully. Run dotnet pack on each project to ensure NuGet packages are generated with correct metadata."
          },
          {
            "id": 2,
            "title": "Set Up Inter-Project Dependencies and Package References",
            "description": "Configure proper dependencies between ThirdOpinion.Common projects and update the meta-package to reference all sub-packages correctly",
            "dependencies": [
              1
            ],
            "details": "Add ProjectReference entries in projects that depend on each other (e.g., ThirdOpinion.Common.Fhir.Documents will reference ThirdOpinion.Common.Aws.HealthLake). Update ThirdOpinion.Common.csproj to include PackageReference entries for all sub-packages that will be published. Configure version consistency across all packages using a shared property or version file. Ensure AWS SDK dependencies are properly configured with consistent versions across all projects. Set up proper dependency chains so packages install their required dependencies automatically.",
            "status": "pending",
            "testStrategy": "Create a test project and attempt to install the meta-package to verify all dependencies resolve correctly. Validate that transitive dependencies are properly handled."
          },
          {
            "id": 3,
            "title": "Update Functional Tests with FhirTools Migration",
            "description": "Migrate and update ThirdOpinion.Common.FunctionalTests to include tests from FhirTools.FunctionalTests and add coverage for new projects",
            "dependencies": [
              2
            ],
            "details": "Review existing FhirTools.FunctionalTests code at /Users/ken/code/ThirdOpinion/FhirTools/FhirTools.FunctionalTests. Migrate relevant test cases to ThirdOpinion.Common.FunctionalTests while updating namespaces and references. Add test coverage for new projects including ThirdOpinion.Common.Aws.HealthLake, ThirdOpinion.Common.Aws.Bedrock, and ThirdOpinion.Common.Fhir.Documents. Update project references in the test project to include all new library projects. Configure test settings and ensure AWS credential handling works properly for functional tests. Update appsettings.Test.json with any new configuration requirements.",
            "status": "pending",
            "testStrategy": "Run all functional tests locally with dotnet test. Verify AWS integration tests work with proper credentials. Ensure test coverage includes all major functionality from migrated projects."
          },
          {
            "id": 4,
            "title": "Create Comprehensive Usage Documentation",
            "description": "Create ThirdOpinion.Common.Usage.md with complete documentation covering all projects, usage patterns, migration guide, and examples",
            "dependencies": [
              3
            ],
            "details": "Create a comprehensive markdown file at the root level named ThirdOpinion.Common.Usage.md. Include an overview section describing each project (ThirdOpinion.Common.Aws.Cognito, DynamoDb, S3, SQS, HealthLake, Bedrock, Fhir, Fhir.Documents, Misc). Document key interfaces and their usage patterns for each project. Provide configuration requirements including AWS credentials, regions, and service-specific settings. Include code examples for common scenarios like FHIR resource creation, AWS service integration, document handling. Add a migration guide section explaining how to migrate from FhirTools to ThirdOpinion.Common packages. Include troubleshooting section for common issues.",
            "status": "pending",
            "testStrategy": "Review documentation for completeness and accuracy. Validate all code examples compile and run correctly. Ensure migration instructions work for a sample project."
          },
          {
            "id": 5,
            "title": "Configure CI/CD Pipeline for Package Publishing",
            "description": "Update the existing CI/CD pipeline to handle building, testing, and publishing all new NuGet packages including proper versioning and dependency management",
            "dependencies": [
              4
            ],
            "details": "Update .github/workflows/ci-cd.yml to build all new projects in the correct order based on dependencies. Configure the packaging step to generate NuGet packages for all library projects, not just ThirdOpinion.Common meta-package. Update version determination logic to handle multiple packages with synchronized versioning. Ensure the pipeline handles project dependencies correctly during the build phase. Configure package validation to check all generated packages before publishing. Update the publish steps to push all packages to AWS CodeArtifact in the correct order to satisfy dependencies. Add package dependency validation to ensure packages reference correct versions of sibling packages.",
            "status": "pending",
            "testStrategy": "Run the CI/CD pipeline in a test environment to verify all packages build and pack successfully. Test package publishing to a development repository. Verify that consuming applications can install and use the published packages correctly."
          }
        ]
      }
    ],
    "metadata": {
      "created": "2025-08-14T03:46:08.337Z",
      "updated": "2025-10-29T01:14:50.180Z",
      "description": "Tasks for master context"
    }
  }
}